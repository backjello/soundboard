<div class="dashboard-container">
  <header class="dashboard-header">
    <h1>ğŸµ Soundboard Dashboard</h1>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="openUploadModal()">
        ğŸ“¤ Upload Audio
      </button>
      <button class="btn btn-secondary" (click)="logout()">
        ğŸšª Logout
      </button>
    </div>
  </header>

  <!-- Search and Filter Controls -->
  <div class="search-controls">
    <div class="search-bar">
      <input type="text" [(ngModel)]="searchQuery" (input)="onSearchChange()" placeholder="ğŸ” Search audio files..."
        class="search-input" />
      <button *ngIf="searchQuery" class="btn btn-sm btn-secondary clear-search" (click)="clearSearch()"
        title="Clear search">
        âœ—
      </button>
    </div>
    <div class="filter-controls">
      <button class="btn filter-btn" [class.active]="showFavoritesOnly" (click)="onFavoritesToggle()"
        title="Show favorites only">
        <span *ngIf="!showFavoritesOnly">â­ Show Favorites</span>
        <span *ngIf="showFavoritesOnly">ğŸ“‹ Show All</span>
      </button>
    </div>
  </div>

  <div class="dashboard-content">
    <div *ngIf="isLoading" class="loading">
      <p>â³ Loading audio files...</p>
    </div>

    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="!isLoading && audioList.length === 0" class="empty-state">
      <h3>ğŸ§ No audio files yet</h3>
      <p>Upload your first audio file to get started!</p>
      <button class="btn btn-primary" (click)="openUploadModal()">
        ğŸ“¤ Upload Audio
      </button>
    </div>

    <div *ngIf="!isLoading && audioList.length > 0" class="audio-grid">
      <div *ngFor="let audio of audioList" class="audio-card">
        <div class="audio-info">
          <div *ngIf="editingAudio?.id !== audio.id">
            <h3 class="audio-name">{{ audio.name }}</h3>
          </div>
          <div *ngIf="editingAudio?.id === audio.id" class="audio-rename">
            <input type="text" [(ngModel)]="newName" class="rename-input" (keyup.enter)="confirmRename()"
              (keyup.escape)="cancelRename()" placeholder="Enter new name" />
            <div class="rename-actions">
              <button class="btn btn-sm btn-success" (click)="confirmRename()" title="Confirm rename">
                âœ“
              </button>
              <button class="btn btn-sm btn-secondary" (click)="cancelRename()" title="Cancel rename">
                âœ—
              </button>
            </div>
          </div>
          <p class="audio-meta">
            Uploaded by: {{ audio.uploadedBy?.fullName || audio.uploadedBy?.email }}
          </p>
          <p class="audio-date">
            {{ audio.createdAt | date:'short' }}
          </p>
        </div>

        <div class="audio-actions">
          <button class="btn btn-play" (click)="playAudio(audio)" title="Play audio">
            â–¶ï¸ Play
          </button>
          <button class="btn btn-favorite" [class.favorited]="audio.isFavorited" (click)="toggleFavorite(audio)"
            [title]="audio.isFavorited ? 'Remove from favorites' : 'Add to favorites'">
            <span *ngIf="!audio.isFavorited">â­ Favorite</span>
            <span *ngIf="audio.isFavorited">â¤ï¸ Favorited</span>
          </button>
          <button *ngIf="canEditAudio(audio) && editingAudio?.id !== audio.id" class="btn btn-edit"
            (click)="startRename(audio)" title="Rename audio">
            âœï¸ Rename
          </button>
          <button *ngIf="canEditAudio(audio)" class="btn btn-danger" (click)="deleteAudio(audio)" title="Delete audio">
            ğŸ—‘ï¸ Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Modal -->
  <div *ngIf="showUploadModal" class="modal-overlay" (click)="closeUploadModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <app-audio-upload (uploadComplete)="closeUploadModal()"></app-audio-upload>
    </div>
  </div>
</div>